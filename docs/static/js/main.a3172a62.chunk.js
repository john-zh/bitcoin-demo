(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{146:function(e,t,a){"use strict";(function(e){var n=a(8),s=a(147),o=a(148),r=a(162),c=a(149),i=a(161),l=a(58),d=a(0),m=a.n(d),u=a(34),p=a.n(u),b=(a(254),a(45)),g=a(52),y=a(318),h=a(26),f=a(163),v=a(68),E=a.n(v),x=a(71),O=a.n(x),A=a(159),j=a(100),S=a.n(j),w="4a7af9bcf8ad441e84d71f0c478c5bb1",k="https://api.blockcypher.com/v1/btc/test3",T=p.a.networks.testnet,C=b.a.TextArea,I=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).createTestAddress=function(){var e=p.a.ECPair.makeRandom({network:T}),t=p.a.payments.p2pkh({pubkey:e.publicKey,network:T}).testAddress;a.setState({testAddress:t})},a.generateMnemonic=function(){var e=O.a.generateMnemonic();localStorage.setItem("mnemonic",e);var t=O.a.mnemonicToSeed(e),n=E.a.fromSeed(t,T),s=n.toWIF(),o=n.neutered().toBase58(),r=a.getAddress(n.derivePath("m/44'/0'/0'/0/0"),T);a.setState({mnemonic:e,testAddress:r,privateKey:s,publicKey:o})},a.importFromMnemonic=function(){localStorage.setItem("mnemonic",a.state.mnemonic);var e=O.a.mnemonicToSeed(a.state.mnemonic),t=E.a.fromSeed(e,T),n=t.toWIF(),s=t.neutered().toBase58();a.myNode=t.derivePath("m/44'/0'/0'/0/0");var o=a.getAddress(a.myNode,T);a.setState({testAddress:o,privateKey:n,publicKey:s})},a.getBalance=function(){a.setState({loading:Object(n.a)({},a.state.loading,{balance:!0})}),fetch("".concat(k,"/addrs/").concat(a.state.testAddress,"?token=").concat(w,"&unspentOnly=true")).then(function(e){return e.json()}).then(function(e){console.log(e),a.setState({loading:Object(n.a)({},a.state.loading,{balance:!1})});var t=e.balance||0,s=e.txrefs;a.utxos&&(a.utxos=s.sort(function(e,t){return e.value-t.value})),a.setState({balance:t,utxos:s})}).catch(function(e){a.setState({loading:Object(n.a)({},a.state.loading,{balance:!1})}),console.log(e)})},a.getRealAmount=function(e){return parseInt(e*Math.pow(10,8))},a.buildTrans=function(){var e=Object(l.a)(Object(l.a)(a)).state;if(e.balance)if(e.transAddress)if(e.transAmount)if(e.transAmount>=a.getRealAmount(e.balance))g.a.error("\u4f59\u989d\u4e0d\u8db3");else{var t=p.a.ECPair.fromWIF(a.myNode.toWIF(),T),n=new p.a.TransactionBuilder(T);n.setVersion(1);var s=0,o=0;a.utxos.every(function(t,a){return!((s+=t.value)>e.transAmount)||(o=a,!1)});for(var r=0;r<=o;r++)n.addInput(a.utxos[r].tx_hash,a.utxos[r].tx_output_n);n.addOutput(a.state.transAddress,a.getRealAmount(a.state.transAmount)),n.addOutput(a.state.testAddress,s-a.getRealAmount(a.state.transAmount)-a.getRealAmount(e.fees));for(var c=0;c<=o;c++)n.sign(c,t);console.log(n.build().getId()),a.setState({buildHex:n.build().toHex()})}else g.a.error("\u8bf7\u586b\u5199\u8f6c\u8d26\u91d1\u989d");else g.a.error("\u8bf7\u586b\u5199\u8f6c\u8d26\u5730\u5740");else g.a.error("\u4f59\u989d\u4e0d\u8db3")},a.broadcastTrans=function(){a.setState({loading:Object(n.a)({},a.state.loading,{broadcast:!0})}),fetch("${url}/txs/push",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({tx:a.state.buildHex})}).then(function(e){return e.json()}).then(function(e){e.error&&g.a.error(e.error),a.setState({loading:Object(n.a)({},a.state.loading,{broadcast:!1})}),a.setState({broadcastRes:e}),console.log(e)}).catch(function(e){g.a.error(e.message),a.setState({loading:Object(n.a)({},a.state.loading,{broadcast:!1})}),console.log(e)})},a.state={test:!0,testAddress:"",transAddress:"",transAmount:0,fees:1693e-7,privateKey:"",publicKey:"",balance:"",buildHex:"",broadcastRes:{},loading:{balance:!1,broadcast:!1},mnemonic:""},a}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.bitcoin=p.a;var t=localStorage.getItem("mnemonic");t&&this.setState({mnemonic:t},function(){e.importFromMnemonic()})}},{key:"getAddress",value:function(e,t){return p.a.payments.p2pkh({pubkey:e.publicKey,network:t}).address}},{key:"render",value:function(){var e=this,t={display:"flex",alignItems:"center"},a={minWidth:"139px",maxWidth:"139px",width:"200px"};return m.a.createElement("div",{className:"App",style:{padding:"10px",textAlign:"left"}},m.a.createElement("section",{style:{display:"flex"}},m.a.createElement("div",{style:a},"\u4f7f\u7528\u6d4b\u8bd5\u7f51\u7edc"),m.a.createElement(y.a,{checked:this.state.test,disabled:!0,onChange:function(t){return e.setState({test:t})}}),m.a.createElement("span",{style:{marginLeft:"10px",color:"red"}},"\u8bf7\u6309\u987a\u5e8f\u64cd\u4f5c->\u751f\u6210\u6216\u5bfc\u5165->\u83b7\u53d6\u4f59\u989d->\u6784\u5efa\u8f6c\u8d26->\u5e7f\u64ad")),m.a.createElement("section",{style:{display:"flex",marginTop:"10px"}},m.a.createElement("div",{style:a},m.a.createElement(h.a,{onClick:this.generateMnemonic},"\u751f\u6210\u52a9\u8bb0\u8bcd"),m.a.createElement(h.a,{style:{marginTop:"5px"},onClick:this.importFromMnemonic},"\u5bfc\u5165\u52a9\u8bb0\u8bcd")),m.a.createElement(C,{value:this.state.mnemonic,onChange:function(t){return e.setState({mnemonic:t.target.value})}})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u6211\u7684\u94b1\u5305\u79c1\u94a5"),m.a.createElement(b.a,{value:this.state.privateKey,readOnly:!0})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u6211\u7684\u94b1\u5305\u516c\u94a5"),m.a.createElement(b.a,{value:this.state.publicKey,readOnly:!0})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u6211\u7684 BTC \u8d26\u6237"),m.a.createElement(b.a,{value:this.state.testAddress,readOnly:!0})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},m.a.createElement(h.a,{onClick:this.getBalance,loading:this.state.loading.balance},"\u67e5\u8be2\u4f59\u989d")),m.a.createElement(b.a,{value:this.state.balance?this.state.balance/Math.pow(10,8):"",readOnly:!0}),m.a.createElement(h.a,{onClick:function(){window.open("https://coinfaucet.eu/en/btc-testnet/")},style:{marginLeft:"10px"}},"\u83b7\u53d6\u6d4b\u8bd5\u91d1")),m.a.createElement("section",{style:Object(n.a)({},t,{fontSize:"12px",color:"grey"})},m.a.createElement("div",{style:a}),"\u63a5\u53e3\u4f7f\u7528\u7b2c\u4e09\u65b9 api, \u53ef\u80fd\u51fa\u73b0\u5ef6\u8fdf\u6216\u8d85\u65f6"),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"UTXOs"),m.a.createElement(S.a,{style:{maxHeight:"300px",overflow:"auto"},src:this.state.utxos})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u8f6c\u8d26\u5730\u5740"),m.a.createElement(b.a,{value:this.state.transAddress,onChange:function(t){return e.setState({transAddress:t.target.value})}})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u8f6c\u8d26\u91d1\u989d"),m.a.createElement(f.a,{step:.001,style:{width:"100%"},value:this.state.transAmount,onChange:function(t){return e.setState({transAmount:t})}})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},"\u8f6c\u8d26\u624b\u7eed\u8d39"),m.a.createElement(f.a,{step:.001,style:{width:"100%"},value:this.state.fees,onChange:function(t){return e.setState({fees:t})}})),m.a.createElement("section",{style:Object(n.a)({},t,{marginTop:"10px"})},m.a.createElement("div",{style:a},m.a.createElement(h.a,{onClick:this.buildTrans},"\u6784\u5efa\u8f6c\u8d26")),m.a.createElement(b.a,{value:this.state.buildHex,readOnly:!0})),m.a.createElement("section",{style:Object(n.a)({},t,{fontSize:"12px",color:"grey",marginTop:"10px"})},m.a.createElement("div",{style:a}),"\u63a5\u53e3\u4f7f\u7528\u7b2c\u4e09\u65b9 api, \u53ef\u80fd\u51fa\u73b0\u5ef6\u8fdf\u6216\u8d85\u65f6"),m.a.createElement("section",{style:Object(n.a)({},t)},m.a.createElement("div",{style:a},m.a.createElement(h.a,{onClick:this.broadcastTrans,loading:this.state.loading.broadcast},"\u5e7f\u64ad\u8f6c\u8d26")),m.a.createElement(S.a,{style:{maxHeight:"300px",overflow:"auto"},src:this.state.broadcastRes})))}}]),t}(d.Component);t.a=Object(A.hot)(e)(I)}).call(this,a(173)(e))},165:function(e,t,a){e.exports=a(317)},170:function(e,t,a){},177:function(e,t){},181:function(e,t){},203:function(e,t){},205:function(e,t){},254:function(e,t,a){},317:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(25),r=a.n(o),c=(a(170),a(146));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(c.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[165,2,1]]]);
//# sourceMappingURL=main.a3172a62.chunk.js.map